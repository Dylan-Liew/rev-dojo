
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dylan-liew.github.io/rev-dojo/reverse-engineering/static/02-control-flow/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Control Flow & Function Analysis - Rev-Dojo</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#control-flow-function-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Rev-Dojo" class="md-header__button md-logo" aria-label="Rev-Dojo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rev-Dojo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Control Flow &amp; Function Analysis
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Rev-Dojo" class="md-nav__button md-logo" aria-label="Rev-Dojo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Rev-Dojo
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundations/01-c-essentials-i/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C Programming Essentials I
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundations/01-c-essentials-ii/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C Programming Essentials II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundations/02-compilation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compilation Process
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#understanding-control-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Control Flow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding Control Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-control-flow" class="md-nav__link">
    <span class="md-ellipsis">
      What is Control Flow?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-flow-graph-cfg" class="md-nav__link">
    <span class="md-ellipsis">
      Control Flow Graph (CFG)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-identification" class="md-nav__link">
    <span class="md-ellipsis">
      Function Identification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Function Identification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-prologue-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Function Prologue Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Function Prologue Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#x86-64-function-prologue" class="md-nav__link">
    <span class="md-ellipsis">
      x86-64 Function Prologue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#x86-32-function-prologue" class="md-nav__link">
    <span class="md-ellipsis">
      x86-32 Function Prologue
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-epilogue-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Function Epilogue Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-recognition-in-ida-pro" class="md-nav__link">
    <span class="md-ellipsis">
      Function Recognition in IDA Pro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Function Recognition in IDA Pro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-function-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Function Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-function-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Function Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-analysis-window" class="md-nav__link">
    <span class="md-ellipsis">
      Function Analysis Window
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-recognition-in-ghidra" class="md-nav__link">
    <span class="md-ellipsis">
      Function Recognition in Ghidra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Function Recognition in Ghidra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Function Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#call-graph-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Call Graph Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Call Graph Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-call-relationships" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Call Relationships
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-graph-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Call Graph Visualization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Call Graph Visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ida-pro-call-graph" class="md-nav__link">
    <span class="md-ellipsis">
      IDA Pro Call Graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ghidra-function-call-trees" class="md-nav__link">
    <span class="md-ellipsis">
      Ghidra Function Call Trees
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-call-graph-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Call Graph Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control-flow-analysis-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      Control Flow Analysis Techniques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Control Flow Analysis Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-block-identification" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Block Identification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loop-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Loop Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Loop Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-loop-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Loop Patterns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditional-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Conditional Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conditional Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#branch-prediction-and-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Branch Prediction and Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-control-flow-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Control Flow Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Control Flow Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jump-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Jump Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indirect-calls-and-virtual-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Indirect Calls and Virtual Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exception-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Exception Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-analysis-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Analysis Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Analysis Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-recursive-function-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Recursive Function Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-state-machine-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: State Machine Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ida-pro-advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      IDA Pro Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IDA Pro Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flow-chart-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Flow Chart Generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-references" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-References
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Function Comparison
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ghidra-advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Ghidra Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ghidra Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decompiler-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Decompiler Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-based-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Script-based Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automated-analysis-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Automated Analysis Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automated Analysis Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#angr-control-flow-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      angr Control Flow Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#radare2-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Radare2 Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#control-flow-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Control Flow Documentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-naming-conventions" class="md-nav__link">
    <span class="md-ellipsis">
      Function Naming Conventions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis Workflow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="control-flow-function-analysis">Control Flow &amp; Function Analysis</h1>
<p>Control flow analysis is fundamental to understanding how a program executes. This section covers techniques for analyzing function structures, call graphs, and execution paths using static analysis tools.</p>
<h2 id="understanding-control-flow">Understanding Control Flow</h2>
<h3 id="what-is-control-flow">What is Control Flow?</h3>
<p>Control flow represents the order in which program instructions are executed:</p>
<ul>
<li><strong>Sequential execution</strong> - Instructions executed one after another</li>
<li><strong>Conditional branches</strong> - Execution paths based on conditions</li>
<li><strong>Loops</strong> - Repeated execution of code blocks</li>
<li><strong>Function calls</strong> - Transfer control to subroutines</li>
<li><strong>Exception handling</strong> - Alternative execution paths for errors</li>
</ul>
<h3 id="control-flow-graph-cfg">Control Flow Graph (CFG)</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code>Example CFG:
    [Entry]
       |
   [Condition]
    /       \
[True]    [False]
   |         |
[Action A] [Action B]
    \       /
    [Merge]
       |
    [Exit]
</code></pre></div></td></tr></table></div>
<h2 id="function-identification">Function Identification</h2>
<h3 id="function-prologue-patterns">Function Prologue Patterns</h3>
<p>Most functions follow predictable patterns for setup and cleanup:</p>
<h4 id="x86-64-function-prologue">x86-64 Function Prologue</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Standard prologue</span>
<span class="nf">push</span><span class="w">    </span><span class="no">rbp</span><span class="w">          </span><span class="c1">; Save old frame pointer</span>
<span class="nf">mov</span><span class="w">     </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span><span class="w">     </span><span class="c1">; Set new frame pointer</span>
<span class="nf">sub</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">0x20</span><span class="w">    </span><span class="c1">; Allocate stack space for locals</span>

<span class="c1">; Alternative prologue (optimized)</span>
<span class="nf">push</span><span class="w">    </span><span class="no">rbp</span>
<span class="nf">mov</span><span class="w">     </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span>
<span class="nf">and</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">0xFFFFFFF0</span><span class="w">  </span><span class="c1">; Stack alignment</span>
</code></pre></div></td></tr></table></div>
<h4 id="x86-32-function-prologue">x86-32 Function Prologue</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Standard 32-bit prologue</span>
<span class="nf">push</span><span class="w">    </span><span class="no">ebp</span>
<span class="nf">mov</span><span class="w">     </span><span class="no">ebp</span><span class="p">,</span><span class="w"> </span><span class="no">esp</span>
<span class="nf">sub</span><span class="w">     </span><span class="no">esp</span><span class="p">,</span><span class="w"> </span><span class="mi">0x10</span><span class="w">    </span><span class="c1">; Allocate locals</span>
</code></pre></div></td></tr></table></div>
<h3 id="function-epilogue-patterns">Function Epilogue Patterns</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Standard epilogue</span>
<span class="nf">mov</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="no">rbp</span><span class="w">     </span><span class="c1">; Restore stack pointer</span>
<span class="nf">pop</span><span class="w">     </span><span class="no">rbp</span><span class="w">          </span><span class="c1">; Restore frame pointer</span>
<span class="nf">ret</span><span class="w">                  </span><span class="c1">; Return to caller</span>

<span class="c1">; Simplified epilogue</span>
<span class="nf">leave</span><span class="w">               </span><span class="c1">; Equivalent to mov rsp, rbp; pop rbp</span>
<span class="nf">ret</span>

<span class="c1">; Alternative cleanup</span>
<span class="nf">add</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">0x20</span><span class="w">   </span><span class="c1">; Deallocate locals</span>
<span class="nf">pop</span><span class="w">     </span><span class="no">rbp</span>
<span class="nf">ret</span>
</code></pre></div></td></tr></table></div>
<h3 id="function-recognition-in-ida-pro">Function Recognition in IDA Pro</h3>
<h4 id="automatic-function-detection">Automatic Function Detection</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>IDA Pro automatically identifies functions by:
1. Recognizing standard prologues/epilogues
2. Following call instructions
3. Analyzing cross-references
4. Detecting code vs data patterns
</code></pre></div></td></tr></table></div>
<h4 id="manual-function-creation">Manual Function Creation</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>Creating functions manually:
1. Position cursor at function start
2. Press &#39;P&#39; to create function
3. Or Edit → Functions → Create Function
4. Adjust function boundaries if needed
</code></pre></div></td></tr></table></div>
<h4 id="function-analysis-window">Function Analysis Window</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>Functions Window (Shift+F3):
- Lists all identified functions
- Shows function addresses and names
- Allows navigation and renaming
- Displays function statistics
</code></pre></div></td></tr></table></div>
<h3 id="function-recognition-in-ghidra">Function Recognition in Ghidra</h3>
<h4 id="function-manager">Function Manager</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>Window → Function Manager:
- Shows all detected functions
- Provides function signatures
- Allows bulk operations
- Displays calling conventions
</code></pre></div></td></tr></table></div>
<h4 id="creating-functions">Creating Functions</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>Manual function creation:
1. Right-click at function start
2. Select &quot;Create Function&quot;
3. Or press &#39;F&#39; hotkey
4. Adjust parameters if needed
</code></pre></div></td></tr></table></div>
<h2 id="call-graph-analysis">Call Graph Analysis</h2>
<h3 id="understanding-call-relationships">Understanding Call Relationships</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Example program structure</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">helper_function</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">process_data</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">helper_function</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">processed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">process_data</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Result: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">processed</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="call-graph-visualization">Call Graph Visualization</h3>
<h4 id="ida-pro-call-graph">IDA Pro Call Graph</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>View → Graphs → Function Calls:
- Shows function relationships
- Identifies recursive calls
- Highlights critical paths
- Supports filtering and navigation
</code></pre></div></td></tr></table></div>
<h4 id="ghidra-function-call-trees">Ghidra Function Call Trees</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>Window → Function Call Trees:
- Incoming calls (who calls this function)
- Outgoing calls (what this function calls)
- Call depth analysis
- Recursive relationship detection
</code></pre></div></td></tr></table></div>
<h3 id="practical-call-graph-analysis">Practical Call Graph Analysis</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Example assembly showing call relationships</span>
<span class="nl">main:</span>
<span class="w">    </span><span class="nf">push</span><span class="w">    </span><span class="no">rbp</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span>
<span class="w">    </span><span class="nf">sub</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">0x10</span>

<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">edi</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="w">          </span><span class="c1">; Parameter for process_data</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">process_data</span><span class="w">     </span><span class="c1">; Call to process_data</span>

<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">esi</span><span class="p">,</span><span class="w"> </span><span class="no">eax</span><span class="w">         </span><span class="c1">; Result as parameter</span>
<span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="no">format_str</span><span class="w">  </span><span class="c1">; &quot;Result: %d\n&quot;</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">printf</span><span class="w">           </span><span class="c1">; Call to printf</span>

<span class="w">    </span><span class="nf">xor</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="no">eax</span><span class="w">         </span><span class="c1">; Return 0</span>
<span class="w">    </span><span class="nf">leave</span>
<span class="w">    </span><span class="nf">ret</span>

<span class="nl">process_data:</span>
<span class="w">    </span><span class="nf">push</span><span class="w">    </span><span class="no">rbp</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span>
<span class="w">    </span><span class="nf">sub</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">0x10</span>

<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span><span class="w"> </span><span class="no">edi</span><span class="w">     </span><span class="c1">; Store parameter</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">edi</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span><span class="w">     </span><span class="c1">; Load parameter</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">helper_function</span><span class="w">  </span><span class="c1">; Call to helper_function</span>

<span class="w">    </span><span class="nf">add</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w">          </span><span class="c1">; Add 10 to result</span>
<span class="w">    </span><span class="nf">leave</span>
<span class="w">    </span><span class="nf">ret</span>
</code></pre></div></td></tr></table></div>
<h2 id="control-flow-analysis-techniques">Control Flow Analysis Techniques</h2>
<h3 id="basic-block-identification">Basic Block Identification</h3>
<p>Basic blocks are sequences of instructions with:
- Single entry point (first instruction)
- Single exit point (last instruction)
- No internal jumps or branches</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Basic Block Example</span>
<span class="nl">basic_block_1:</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span><span class="w">    </span><span class="c1">; Entry point</span>
<span class="w">    </span><span class="nf">add</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span><span class="w"> </span><span class="no">eax</span>
<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="w">        </span><span class="c1">; Exit point - conditional branch</span>
<span class="w">    </span><span class="nf">jle</span><span class="w">     </span><span class="no">basic_block_2</span>

<span class="nl">basic_block_2:</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span><span class="w">    </span><span class="c1">; Entry point</span>
<span class="w">    </span><span class="nf">imul</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span><span class="w"> </span><span class="no">eax</span><span class="w">    </span><span class="c1">; Exit point - unconditional jump</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">basic_block_3</span>
</code></pre></div></td></tr></table></div>
<h3 id="loop-detection">Loop Detection</h3>
<h4 id="common-loop-patterns">Common Loop Patterns</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; For loop pattern</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">ecx</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w">          </span><span class="c1">; Initialize counter</span>
<span class="nl">for_loop:</span>
<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">ecx</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w">         </span><span class="c1">; Check condition</span>
<span class="w">    </span><span class="nf">jge</span><span class="w">     </span><span class="no">loop_end</span><span class="w">        </span><span class="c1">; Exit if done</span>

<span class="w">    </span><span class="c1">; Loop body</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">process_item</span>

<span class="w">    </span><span class="nf">inc</span><span class="w">     </span><span class="no">ecx</span><span class="w">             </span><span class="c1">; Increment counter</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">for_loop</span><span class="w">        </span><span class="c1">; Back to condition</span>
<span class="nl">loop_end:</span>

<span class="c1">; While loop pattern</span>
<span class="nl">while_loop:</span>
<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w">          </span><span class="c1">; Check condition</span>
<span class="w">    </span><span class="nf">je</span><span class="w">      </span><span class="no">while_end</span><span class="w">       </span><span class="c1">; Exit if condition false</span>

<span class="w">    </span><span class="c1">; Loop body</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">process_data</span>
<span class="w">    </span><span class="nf">dec</span><span class="w">     </span><span class="no">eax</span><span class="w">             </span><span class="c1">; Modify condition variable</span>

<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">while_loop</span><span class="w">      </span><span class="c1">; Back to condition check</span>
<span class="nl">while_end:</span>

<span class="c1">; Do-while loop pattern</span>
<span class="nl">do_while_start:</span>
<span class="w">    </span><span class="c1">; Loop body (executes at least once)</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">process_data</span>

<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w">          </span><span class="c1">; Check condition</span>
<span class="w">    </span><span class="nf">jne</span><span class="w">     </span><span class="no">do_while_start</span><span class="w">  </span><span class="c1">; Continue if condition true</span>
</code></pre></div></td></tr></table></div>
<h3 id="conditional-analysis">Conditional Analysis</h3>
<h4 id="branch-prediction-and-analysis">Branch Prediction and Analysis</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Simple if-else</span>
<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="nf">jle</span><span class="w">     </span><span class="no">else_branch</span><span class="w">     </span><span class="c1">; Jump if eax &lt;= 10</span>

<span class="nl">if_branch:</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">ebx</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">after_if</span>

<span class="nl">else_branch:</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">ebx</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span>

<span class="nl">after_if:</span>
<span class="w">    </span><span class="c1">; Continue execution</span>

<span class="c1">; Switch statement pattern</span>
<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="nf">je</span><span class="w">      </span><span class="no">case_0</span>
<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="nf">je</span><span class="w">      </span><span class="no">case_1</span>
<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nf">je</span><span class="w">      </span><span class="no">case_2</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">default_case</span>

<span class="nl">case_0:</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">handle_case_0</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">switch_end</span>
<span class="nl">case_1:</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">handle_case_1</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">switch_end</span>
<span class="nl">case_2:</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">handle_case_2</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">switch_end</span>
<span class="nl">default_case:</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">handle_default</span>
<span class="nl">switch_end:</span>
</code></pre></div></td></tr></table></div>
<h2 id="advanced-control-flow-analysis">Advanced Control Flow Analysis</h2>
<h3 id="jump-tables">Jump Tables</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Jump table implementation</span>
<span class="nl">switch_handler:</span>
<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w">          </span><span class="c1">; Check bounds</span>
<span class="w">    </span><span class="nf">ja</span><span class="w">      </span><span class="no">default_case</span><span class="w">    </span><span class="c1">; Out of bounds</span>

<span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rip</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="no">jump_table</span><span class="p">]</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbx</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="no">rax</span><span class="p">*</span><span class="mi">8</span><span class="p">]</span><span class="w">  </span><span class="c1">; Get target address</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">rax</span><span class="w">             </span><span class="c1">; Jump to handler</span>

<span class="nl">jump_table:</span>
<span class="w">    </span><span class="nf">dq</span><span class="w">      </span><span class="no">case_0</span><span class="w">          </span><span class="c1">; Case 0 handler</span>
<span class="w">    </span><span class="nf">dq</span><span class="w">      </span><span class="no">case_1</span><span class="w">          </span><span class="c1">; Case 1 handler</span>
<span class="w">    </span><span class="nf">dq</span><span class="w">      </span><span class="no">case_2</span><span class="w">          </span><span class="c1">; Case 2 handler</span>
<span class="w">    </span><span class="nf">dq</span><span class="w">      </span><span class="no">case_3</span><span class="w">          </span><span class="c1">; Case 3 handler</span>
</code></pre></div></td></tr></table></div>
<h3 id="indirect-calls-and-virtual-functions">Indirect Calls and Virtual Functions</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Virtual function call (C++)</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span><span class="w">    </span><span class="c1">; Load object pointer</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rax</span><span class="p">]</span><span class="w">      </span><span class="c1">; Load vtable pointer</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rax</span><span class="err">+</span><span class="mi">16</span><span class="p">]</span><span class="w">   </span><span class="c1">; Load function pointer (offset 16)</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">rax</span><span class="w">             </span><span class="c1">; Indirect call</span>

<span class="c1">; Function pointer call</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rax</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-16</span><span class="p">]</span><span class="w">   </span><span class="c1">; Load function pointer</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">edi</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="w">         </span><span class="c1">; Set parameter</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">rax</span><span class="w">             </span><span class="c1">; Indirect call</span>
</code></pre></div></td></tr></table></div>
<h3 id="exception-handling">Exception Handling</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">; Exception handling (simplified)</span>
<span class="nl">try_block:</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">risky_function</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">no_exception</span>

<span class="nl">exception_handler:</span>
<span class="w">    </span><span class="c1">; Handle exception</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">cleanup_function</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">after_try</span>

<span class="nl">no_exception:</span>
<span class="w">    </span><span class="c1">; Normal execution path</span>

<span class="nl">after_try:</span>
<span class="w">    </span><span class="c1">; Continue execution</span>
</code></pre></div></td></tr></table></div>
<h2 id="practical-analysis-examples">Practical Analysis Examples</h2>
<h3 id="example-1-recursive-function-analysis">Example 1: Recursive Function Analysis</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Factorial function</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">factorial</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Assembly Analysis:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nl">factorial:</span>
<span class="w">    </span><span class="nf">push</span><span class="w">    </span><span class="no">rbp</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span>
<span class="w">    </span><span class="nf">sub</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">0x10</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span><span class="w"> </span><span class="no">edi</span><span class="w">    </span><span class="c1">; Store parameter n</span>

<span class="w">    </span><span class="nf">cmp</span><span class="w">     </span><span class="no">dword</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c1">; Compare n with 1</span>
<span class="w">    </span><span class="nf">jg</span><span class="w">      </span><span class="no">recursive_case</span><span class="w">    </span><span class="c1">; If n &gt; 1, go to recursive case</span>

<span class="nl">base_case:</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">          </span><span class="c1">; Return 1</span>
<span class="w">    </span><span class="nf">jmp</span><span class="w">     </span><span class="no">function_end</span>

<span class="nl">recursive_case:</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span><span class="w">    </span><span class="c1">; Load n</span>
<span class="w">    </span><span class="nf">sub</span><span class="w">     </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">          </span><span class="c1">; n - 1</span>
<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">edi</span><span class="p">,</span><span class="w"> </span><span class="no">eax</span><span class="w">        </span><span class="c1">; Parameter for recursive call</span>
<span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">factorial</span><span class="w">       </span><span class="c1">; Recursive call</span>

<span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">edx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">]</span><span class="w">    </span><span class="c1">; Load original n</span>
<span class="w">    </span><span class="nf">imul</span><span class="w">    </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="no">edx</span><span class="w">        </span><span class="c1">; n * factorial(n-1)</span>

<span class="nl">function_end:</span>
<span class="w">    </span><span class="nf">leave</span>
<span class="w">    </span><span class="nf">ret</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="example-2-state-machine-analysis">Example 2: State Machine Analysis</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Simple state machine</span>
<span class="k">enum</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">STATE_INIT</span><span class="p">,</span><span class="w"> </span><span class="n">STATE_PROCESSING</span><span class="p">,</span><span class="w"> </span><span class="n">STATE_DONE</span><span class="w"> </span><span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">state_machine</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="n">current_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STATE_INIT</span><span class="p">;</span>

<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">current_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">STATE_INIT</span><span class="p">:</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">current_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STATE_PROCESSING</span><span class="p">;</span>
<span class="w">                </span><span class="n">start_processing</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">STATE_PROCESSING</span><span class="p">:</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">current_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STATE_DONE</span><span class="p">;</span>
<span class="w">                </span><span class="n">finish_processing</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">continue_processing</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">STATE_DONE</span><span class="p">:</span>
<span class="w">            </span><span class="n">reset_system</span><span class="p">();</span>
<span class="w">            </span><span class="n">current_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STATE_INIT</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h2 id="ida-pro-advanced-features">IDA Pro Advanced Features</h2>
<h3 id="flow-chart-generation">Flow Chart Generation</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>View → Graphs → Flow chart:
- Visual representation of control flow
- Shows basic blocks and connections
- Supports zooming and navigation
- Helps understand complex functions
</code></pre></div></td></tr></table></div>
<h3 id="cross-references">Cross-References</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>Ctrl+X - Show cross-references:
- Shows where function is called from
- Lists data references
- Identifies code references
- Helps trace execution paths
</code></pre></div></td></tr></table></div>
<h3 id="function-comparison">Function Comparison</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>IDA Pro function comparison:
1. Load two similar binaries
2. Use BinDiff plugin
3. Compare function structures
4. Identify changes and similarities
</code></pre></div></td></tr></table></div>
<h2 id="ghidra-advanced-features">Ghidra Advanced Features</h2>
<h3 id="decompiler-integration">Decompiler Integration</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>Ghidra&#39;s decompiler shows:
- High-level control flow
- Reconstructed if/else statements
- Loop structures
- Function calls with parameters
</code></pre></div></td></tr></table></div>
<h3 id="script-based-analysis">Script-based Analysis</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Ghidra script to analyze control flow</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ghidra.app.script.GhidraScript</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ghidra.program.model.listing.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ghidra.program.model.symbol.*</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AnalyzeControlFlow</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">GhidraScript</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">FunctionManager</span><span class="w"> </span><span class="n">funcMgr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentProgram</span><span class="p">.</span><span class="na">getFunctionManager</span><span class="p">();</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Function</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">funcMgr</span><span class="p">.</span><span class="na">getFunctions</span><span class="p">(</span><span class="kc">true</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Function: %s at %s\n&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">func</span><span class="p">.</span><span class="na">getName</span><span class="p">(),</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="na">getEntryPoint</span><span class="p">());</span>

<span class="w">            </span><span class="c1">// Analyze function calls</span>
<span class="w">            </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Function</span><span class="o">&gt;</span><span class="w"> </span><span class="n">calledFunctions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="na">getCalledFunctions</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Function</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">calledFunctions</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;  Calls: %s\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">called</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Analyze calling functions</span>
<span class="w">            </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Function</span><span class="o">&gt;</span><span class="w"> </span><span class="n">callingFunctions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="na">getCallingFunctions</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Function</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">callingFunctions</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;  Called by: %s\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">calling</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h2 id="automated-analysis-tools">Automated Analysis Tools</h2>
<h3 id="angr-control-flow-analysis">angr Control Flow Analysis</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">angr</span>

<span class="c1"># Load binary</span>
<span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="s1">&#39;./binary&#39;</span><span class="p">,</span> <span class="n">auto_load_libs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Get control flow graph</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">analyses</span><span class="o">.</span><span class="n">CFGFast</span><span class="p">()</span>

<span class="c1"># Analyze function</span>
<span class="n">main_func</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function: </span><span class="si">{</span><span class="n">main_func</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basic blocks: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">main_func</span><span class="o">.</span><span class="n">blocks</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Show call graph</span>
<span class="k">for</span> <span class="n">func_addr</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="n">functions</span><span class="p">:</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="n">func_addr</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">predecessor</span> <span class="ow">in</span> <span class="n">func</span><span class="o">.</span><span class="n">predecessors</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Called by: </span><span class="si">{</span><span class="n">predecessor</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="radare2-analysis">Radare2 Analysis</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Load binary</span>
r2<span class="w"> </span>./binary

<span class="c1"># Analyze all functions</span>
aaa

<span class="c1"># Show function list</span>
afl

<span class="c1"># Show call graph</span>
agC

<span class="c1"># Analyze specific function</span>
pdf<span class="w"> </span>@<span class="w"> </span>main

<span class="c1"># Show cross-references</span>
axt<span class="w"> </span>@<span class="w"> </span>sym.main
</code></pre></div></td></tr></table></div>
<h2 id="best-practices">Best Practices</h2>
<h3 id="control-flow-documentation">Control Flow Documentation</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>1. Start with main function
2. Identify key functions first
3. Map out call relationships
4. Document loop structures
5. Note exception handling paths
6. Track data flow between functions
</code></pre></div></td></tr></table></div>
<h3 id="function-naming-conventions">Function Naming Conventions</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>Naming suggestions:
- Use descriptive names: parse_config vs sub_401000
- Indicate purpose: validate_input, process_data
- Show relationships: init_parser, cleanup_parser
- Mark important functions: crypto_encrypt, auth_check
</code></pre></div></td></tr></table></div>
<h3 id="analysis-workflow">Analysis Workflow</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code>1. Automatic analysis first
2. Review function boundaries
3. Create call graph
4. Identify main execution paths
5. Analyze loop structures
6. Document findings
7. Cross-reference with dynamic analysis
</code></pre></div></td></tr></table></div>
<h2 id="key-takeaways">Key Takeaways</h2>
<div class="admonition important">
<p class="admonition-title">Control Flow Fundamentals</p>
<ul>
<li><strong>Function identification</strong> relies on prologue/epilogue patterns</li>
<li><strong>Call graphs</strong> show program structure and relationships</li>
<li><strong>Basic blocks</strong> are fundamental units of control flow</li>
<li><strong>Loop detection</strong> helps understand program logic</li>
<li><strong>Indirect calls</strong> require special analysis techniques</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Analysis Strategy</p>
<ul>
<li>Start with automatic analysis tools</li>
<li>Use visual representations (flowcharts, call graphs)</li>
<li>Document findings with meaningful names</li>
<li>Combine static and dynamic analysis</li>
<li>Practice recognizing common patterns</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Common Challenges</p>
<ul>
<li>Optimized code may have non-standard patterns</li>
<li>Indirect calls and jump tables complicate analysis</li>
<li>Exception handling creates complex control flows</li>
<li>Obfuscation can hide true control flow</li>
<li>Large binaries require systematic approach</li>
</ul>
</div>
<hr />
<p><em>Next: <a href="../03-strings-symbols/">String &amp; Symbol Analysis</a></em></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.sections", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>