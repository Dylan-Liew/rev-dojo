
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dylan-liew.github.io/rev-dojo/binary-exploitation/protection/01-mitigations/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Understanding Mitigations - Rev-Dojo</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#understanding-mitigations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Rev-Dojo" class="md-header__button md-logo" aria-label="Rev-Dojo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rev-Dojo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Understanding Mitigations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Rev-Dojo" class="md-nav__button md-logo" aria-label="Rev-Dojo" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Rev-Dojo
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundations/01-c-essentials-i/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C Programming Essentials I
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundations/01-c-essentials-ii/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C Programming Essentials II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../foundations/02-compilation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compilation Process
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview-of-security-mitigations" class="md-nav__link">
    <span class="md-ellipsis">
      Overview of Security Mitigations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview of Security Mitigations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-evolution-of-protections" class="md-nav__link">
    <span class="md-ellipsis">
      The Evolution of Protections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#categories-of-mitigations" class="md-nav__link">
    <span class="md-ellipsis">
      Categories of Mitigations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack-protection-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      Stack Protection Mechanisms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stack Protection Mechanisms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stack-canaries-stack-guards" class="md-nav__link">
    <span class="md-ellipsis">
      Stack Canaries (Stack Guards)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stack Canaries (Stack Guards)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-of-stack-canaries" class="md-nav__link">
    <span class="md-ellipsis">
      Types of Stack Canaries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stack-layout-with-canaries" class="md-nav__link">
    <span class="md-ellipsis">
      Stack Layout with Canaries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-stack-canaries" class="md-nav__link">
    <span class="md-ellipsis">
      Analyzing Stack Canaries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#address-space-layout-randomization-aslr" class="md-nav__link">
    <span class="md-ellipsis">
      Address Space Layout Randomization (ASLR)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Address Space Layout Randomization (ASLR)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aslr-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      ASLR Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aslr-levels" class="md-nav__link">
    <span class="md-ellipsis">
      ASLR Levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-aslr-effectiveness" class="md-nav__link">
    <span class="md-ellipsis">
      Testing ASLR Effectiveness
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-execution-prevention-depnx" class="md-nav__link">
    <span class="md-ellipsis">
      Data Execution Prevention (DEP/NX)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Execution Prevention (DEP/NX)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#non-executable-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Non-Executable Memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-support" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#position-independent-executable-pie" class="md-nav__link">
    <span class="md-ellipsis">
      Position Independent Executable (PIE)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Position Independent Executable (PIE)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pie-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      PIE Concepts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control-flow-integrity-cfi" class="md-nav__link">
    <span class="md-ellipsis">
      Control Flow Integrity (CFI)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Control Flow Integrity (CFI)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cfi-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      CFI Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-cfi-features" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware CFI Features
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relro-relocation-read-only" class="md-nav__link">
    <span class="md-ellipsis">
      RELRO (Relocation Read-Only)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RELRO (Relocation Read-Only)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relro-protection" class="md-nav__link">
    <span class="md-ellipsis">
      RELRO Protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-relro" class="md-nav__link">
    <span class="md-ellipsis">
      Testing RELRO
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fortify-source" class="md-nav__link">
    <span class="md-ellipsis">
      Fortify Source
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fortify Source">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fortify_source-protection" class="md-nav__link">
    <span class="md-ellipsis">
      FORTIFY_SOURCE Protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-fortify_source" class="md-nav__link">
    <span class="md-ellipsis">
      Testing FORTIFY_SOURCE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprehensive-protection-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Comprehensive Protection Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comprehensive Protection Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#binary-protection-analysis-tool" class="md-nav__link">
    <span class="md-ellipsis">
      Binary Protection Analysis Tool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-level-protections" class="md-nav__link">
    <span class="md-ellipsis">
      System-Level Protections
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System-Level Protections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kernel-protections" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Protections
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="understanding-mitigations">Understanding Mitigations</h1>
<p>Modern operating systems and compilers implement various security mitigations to make exploitation more difficult. Understanding these protections is crucial for both defensive and offensive security. This chapter covers the most common mitigations and their fundamental principles.</p>
<h2 id="overview-of-security-mitigations">Overview of Security Mitigations</h2>
<h3 id="the-evolution-of-protections">The Evolution of Protections</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code>Timeline of Security Mitigations:
┌─────────────────────┐
│ 1990s: Basic Stack  │ ← Early stack protection attempts
│ Protection          │
├─────────────────────┤
│ 2000s: NX/DEP       │ ← Non-executable memory
├─────────────────────┤
│ 2001: Stack Canaries│ ← GCC stack protection
├─────────────────────┤
│ 2005: ASLR          │ ← Address Space Layout Randomization
├─────────────────────┤
│ 2010s: Enhanced     │ ← SMEP, SMAP, CET
│ Hardware Features   │
├─────────────────────┤
│ 2020s: Modern       │ ← CET, PAC, BTI
│ Hardware Mitigations│
└─────────────────────┘
</code></pre></div></td></tr></table></div>
<h3 id="categories-of-mitigations">Categories of Mitigations</h3>
<ol>
<li><strong>Preventive</strong> - Stop exploitation attempts</li>
<li><strong>Detective</strong> - Detect exploitation attempts</li>
<li><strong>Mitigative</strong> - Reduce impact of successful exploitation</li>
</ol>
<h2 id="stack-protection-mechanisms">Stack Protection Mechanisms</h2>
<h3 id="stack-canaries-stack-guards">Stack Canaries (Stack Guards)</h3>
<p>Stack canaries are values placed between local variables and the return address to detect buffer overflows.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// How stack canaries work</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">function_with_canary</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Compiler inserts canary value</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">canary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_random_canary</span><span class="p">();</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span><span class="w">  </span><span class="c1">// Local variables</span>

<span class="w">    </span><span class="c1">// User code here...</span>

<span class="w">    </span><span class="c1">// Before return, compiler checks canary</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">canary</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">get_original_canary</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">abort</span><span class="p">();</span><span class="w">  </span><span class="c1">// Stack smashing detected</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="p">;</span><span class="w">  </span><span class="c1">// Safe to return</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="types-of-stack-canaries">Types of Stack Canaries</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// 1. Terminator canaries (null, newline, EOF, -1)</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">terminator_canary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x000aff0d</span><span class="p">;</span>

<span class="c1">// 2. Random canaries  </span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">random_canary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random_value</span><span class="p">();</span>

<span class="c1">// 3. Random XOR canaries</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">xor_canary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random_value</span><span class="p">()</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">return_address</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<h4 id="stack-layout-with-canaries">Stack Layout with Canaries</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code>Stack Layout:
High Address
┌─────────────────────┐
│   Function Args     │
├─────────────────────┤
│   Return Address    │ ← Protected by canary
├─────────────────────┤
│   Saved Frame Ptr   │
├─────────────────────┤
│   Stack Canary      │ ← Detection mechanism
├─────────────────────┤
│   Local Variables   │
│   (buffer)          │
└─────────────────────┘
Low Address
</code></pre></div></td></tr></table></div>
<h3 id="analyzing-stack-canaries">Analyzing Stack Canaries</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span><span class="w"> </span><span class="nf">analyze_canary_protection</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze how stack canaries work&quot;&quot;&quot;</span>

    <span class="c1"># Compile test program with different canary settings</span>
    <span class="n">test_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#include &lt;stdio.h&gt;</span>
<span class="s1">#include &lt;string.h&gt;</span>

<span class="s1">void vulnerable_function() {</span>
<span class="s1">    char buffer[64];</span>
<span class="s1">    printf(&quot;Enter input: &quot;);</span>
<span class="s1">    gets(buffer);</span>
<span class="s1">    printf(&quot;Input: </span><span class="si">%s</span><span class="se">\\</span><span class="s1">n&quot;, buffer);</span>
<span class="s1">}</span>

<span class="s1">int main() {</span>
<span class="s1">    vulnerable_function();</span>
<span class="s1">    return 0;</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stack canary analysis:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Compile without canaries: gcc -fno-stack-protector&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Compile with canaries: gcc -fstack-protector-all&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Try buffer overflow and observe behavior&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">detect_canary_implementation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Detect canary implementation details&quot;&quot;&quot;</span>

    <span class="n">canary_test_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#include &lt;stdio.h&gt;</span>
<span class="s1">#include &lt;unistd.h&gt;</span>

<span class="s1">void show_canary_location() {</span>
<span class="s1">    char buffer[64];</span>
<span class="s1">    unsigned long canary;</span>

<span class="s1">    // This is implementation-specific</span>
<span class="s1">    // Canary is typically at </span><span class="si">%f</span><span class="s1">s:0x28 on x86_64</span>
<span class="s1">    asm(&quot;mov </span><span class="si">%%</span><span class="s1">fs:0x28, %0&quot; : &quot;=r&quot; (canary));</span>

<span class="s1">    printf(&quot;Buffer address: %p</span><span class="se">\\</span><span class="s1">n&quot;, buffer);</span>
<span class="s1">    printf(&quot;Canary value: 0x</span><span class="si">%016lx</span><span class="se">\\</span><span class="s1">n&quot;, canary);</span>
<span class="s1">    printf(&quot;Canary location: </span><span class="si">%%</span><span class="s1">fs:0x28</span><span class="se">\\</span><span class="s1">n&quot;);</span>
<span class="s1">}</span>

<span class="s1">int main() {</span>
<span class="s1">    show_canary_location();</span>
<span class="s1">    return 0;</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Canary implementation details:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- x86_64: Stored at </span><span class="si">%f</span><span class="s2">s:0x28&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- ARM64: Stored in special register&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Initialized at process startup&quot;</span><span class="p">)</span>

<span class="n">analyze_canary_protection</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="address-space-layout-randomization-aslr">Address Space Layout Randomization (ASLR)</h2>
<h3 id="aslr-concepts">ASLR Concepts</h3>
<p>ASLR randomizes the memory layout of processes to make exploitation unpredictable.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code>Memory Layout with ASLR:
┌─────────────────────┐
│ Stack               │ ← Randomized base address
│ 0x7fff????0000     │
├─────────────────────┤
│ Libraries (libc)    │ ← Randomized load addresses
│ 0x7f??????0000     │
├─────────────────────┤
│ Heap                │ ← Randomized heap base
│ 0x????00000000     │
├─────────────────────┤
│ Program Binary      │ ← May be randomized (PIE)
│ 0x400000 or random  │
└─────────────────────┘
</code></pre></div></td></tr></table></div>
<h3 id="aslr-levels">ASLR Levels</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Check ASLR status on Linux</span>
cat<span class="w"> </span>/proc/sys/kernel/randomize_va_space
<span class="c1"># 0 = Disabled</span>
<span class="c1"># 1 = Conservative (stack, libraries, heap)</span>
<span class="c1"># 2 = Full (includes program binary with PIE)</span>

<span class="c1"># Disable ASLR for testing</span>
<span class="nb">echo</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/proc/sys/kernel/randomize_va_space

<span class="c1"># Enable full ASLR</span>
<span class="nb">echo</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/proc/sys/kernel/randomize_va_space
</code></pre></div></td></tr></table></div>
<h3 id="testing-aslr-effectiveness">Testing ASLR Effectiveness</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_aslr_randomization</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test ASLR randomization effectiveness&quot;&quot;&quot;</span>

    <span class="n">test_program</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#include &lt;stdio.h&gt;</span>
<span class="s1">#include &lt;stdlib.h&gt;</span>

<span class="s1">int main() {</span>
<span class="s1">    char stack_var;</span>
<span class="s1">    char *heap_var = malloc(10);</span>

<span class="s1">    printf(&quot;Stack: %p</span><span class="se">\\</span><span class="s1">n&quot;, &amp;stack_var);</span>
<span class="s1">    printf(&quot;Heap: %p</span><span class="se">\\</span><span class="s1">n&quot;, heap_var);</span>
<span class="s1">    printf(&quot;Main: %p</span><span class="se">\\</span><span class="s1">n&quot;, main);</span>
<span class="s1">    printf(&quot;Libc: %p</span><span class="se">\\</span><span class="s1">n&quot;, printf);</span>

<span class="s1">    free(heap_var);</span>
<span class="s1">    return 0;</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ASLR randomization test:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run the same program multiple times and observe address changes&quot;</span><span class="p">)</span>

    <span class="c1"># Collect addresses from multiple runs</span>
    <span class="n">addresses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;stack&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;heap&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;main&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;libc&#39;</span><span class="p">:</span> <span class="p">[]}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;./aslr_test&#39;</span><span class="p">],</span> 
                                  <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

            <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;Stack:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">addr</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">addresses</span><span class="p">[</span><span class="s1">&#39;stack&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">&#39;Heap:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">addr</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">addresses</span><span class="p">[</span><span class="s1">&#39;heap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">&#39;Main:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">addr</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">addresses</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">&#39;Libc:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">addr</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">addresses</span><span class="p">[</span><span class="s1">&#39;libc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="c1"># Analyze randomization</span>
    <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">addrs</span> <span class="ow">in</span> <span class="n">addresses</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">unique_addrs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">addrs</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">unique_addrs</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">addrs</span><span class="p">)</span><span class="si">}</span><span class="s2"> unique addresses&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calculate_aslr_entropy</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate ASLR entropy&quot;&quot;&quot;</span>

    <span class="n">entropy_info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;stack&#39;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span>      <span class="c1"># bits of randomization</span>
        <span class="s1">&#39;heap&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>       <span class="c1"># typical heap randomization</span>
        <span class="s1">&#39;libraries&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>  <span class="c1"># library load addresses</span>
        <span class="s1">&#39;pie&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>        <span class="c1"># PIE randomization</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Typical ASLR entropy (bits):&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">component</span><span class="p">,</span> <span class="n">bits</span> <span class="ow">in</span> <span class="n">entropy_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">possibilities</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">bits</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">component</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">bits</span><span class="si">}</span><span class="s2"> bits (</span><span class="si">{</span><span class="n">possibilities</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> possibilities)&quot;</span><span class="p">)</span>

<span class="n">test_aslr_randomization</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="data-execution-prevention-depnx">Data Execution Prevention (DEP/NX)</h2>
<h3 id="non-executable-memory">Non-Executable Memory</h3>
<p>DEP/NX prevents execution of code in data segments.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code>Memory Permissions:
┌─────────────────────┬─────┬─────┬─────┐
│ Segment             │  R  │  W  │  X  │
├─────────────────────┼─────┼─────┼─────┤
│ Code (.text)        │  ✓  │  ✗  │  ✓  │
│ Data (.data)        │  ✓  │  ✓  │  ✗  │
│ BSS                 │  ✓  │  ✓  │  ✗  │
│ Stack               │  ✓  │  ✓  │  ✗  │ ← NX prevents shellcode
│ Heap                │  ✓  │  ✓  │  ✗  │ ← NX prevents shellcode
└─────────────────────┴─────┴─────┴─────┘
</code></pre></div></td></tr></table></div>
<h3 id="hardware-support">Hardware Support</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_nx_support</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check NX/DEP hardware support&quot;&quot;&quot;</span>

    <span class="c1"># Check CPU features</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check for NX bit support</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;/proc/cpuinfo&#39;</span><span class="p">],</span> 
                              <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;nx&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ NX bit supported by CPU&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✗ NX bit not supported&quot;</span><span class="p">)</span>

        <span class="c1"># Check current process memory mappings</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/proc/self/maps&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">maps</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory mappings for current process:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">maps</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]:</span>  <span class="c1"># First 10 lines</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">address</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">perms</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">perms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not check NX support&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_executable_stack</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if stack is executable&quot;&quot;&quot;</span>

    <span class="n">test_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#include &lt;stdio.h&gt;</span>
<span class="s1">#include &lt;sys/mman.h&gt;</span>
<span class="s1">#include &lt;unistd.h&gt;</span>
<span class="s1">#include &lt;string.h&gt;</span>

<span class="s1">// Shellcode: just returns</span>
<span class="s1">unsigned char shellcode[] = &quot;</span><span class="se">\\</span><span class="s1">xc3&quot;;  // ret instruction</span>

<span class="s1">int main() {</span>
<span class="s1">    printf(&quot;Testing stack execution...</span><span class="se">\\</span><span class="s1">n&quot;);</span>

<span class="s1">    // Try to execute code on stack</span>
<span class="s1">    char stack_code[16];</span>
<span class="s1">    memcpy(stack_code, shellcode, sizeof(shellcode));</span>

<span class="s1">    printf(&quot;Attempting to execute stack code...</span><span class="se">\\</span><span class="s1">n&quot;);</span>

<span class="s1">    // This should fail with NX enabled</span>
<span class="s1">    ((void(*)())stack_code)();</span>

<span class="s1">    printf(&quot;Stack execution succeeded (NX disabled)</span><span class="se">\\</span><span class="s1">n&quot;);</span>
<span class="s1">    return 0;</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stack execution test:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compile with: gcc -z execstack (allows stack execution)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compile with: gcc -z noexecstack (prevents stack execution)&quot;</span><span class="p">)</span>

<span class="n">check_nx_support</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="position-independent-executable-pie">Position Independent Executable (PIE)</h2>
<h3 id="pie-concepts">PIE Concepts</h3>
<p>PIE extends ASLR to randomize the program binary's load address.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span><span class="w"> </span><span class="nf">analyze_pie_protection</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze PIE protection&quot;&quot;&quot;</span>

    <span class="c1"># Non-PIE binary</span>
    <span class="n">non_pie_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#include &lt;stdio.h&gt;</span>

<span class="s1">int main() {</span>
<span class="s1">    printf(&quot;main() at: %p</span><span class="se">\\</span><span class="s1">n&quot;, main);</span>
<span class="s1">    return 0;</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="c1"># PIE binary  </span>
    <span class="n">pie_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#include &lt;stdio.h&gt;</span>

<span class="s1">int main() {</span>
<span class="s1">    printf(&quot;main() at: %p</span><span class="se">\\</span><span class="s1">n&quot;, main);</span>
<span class="s1">    return 0;</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PIE analysis:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Non-PIE: gcc -no-pie -o non_pie program.c&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  - main() always at same address (e.g., 0x401234)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PIE: gcc -fPIE -pie -o pie_binary program.c&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  - main() at random address each run&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">detect_pie_binary</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Detect if binary is compiled with PIE&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_pie</span><span class="p">(</span><span class="n">binary_path</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Use readelf to check for PIE</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;readelf&#39;</span><span class="p">,</span> <span class="s1">&#39;-h&#39;</span><span class="p">,</span> <span class="n">binary_path</span><span class="p">],</span>
                                  <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;DYN&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">: PIE enabled (Dynamic)&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;EXEC&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">: PIE disabled (Executable)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">: Unknown type&quot;</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not analyze </span><span class="si">{</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Example usage</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PIE detection using readelf:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type: EXEC = No PIE, DYN = PIE enabled&quot;</span><span class="p">)</span>

<span class="n">analyze_pie_protection</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="control-flow-integrity-cfi">Control Flow Integrity (CFI)</h2>
<h3 id="cfi-concepts">CFI Concepts</h3>
<p>CFI prevents attackers from hijacking program control flow.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// CFI Example</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">legitimate_function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Legitimate function</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">attacker_function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Attacker function</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">system</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">func_ptr</span><span class="p">)()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">legitimate_function</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Without CFI: attacker can change func_ptr to attacker_function</span>
<span class="w">    </span><span class="c1">// With CFI: call will be validated against allowed targets</span>

<span class="w">    </span><span class="n">func_ptr</span><span class="p">();</span><span class="w">  </span><span class="c1">// CFI checks if this is a valid call target</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="hardware-cfi-features">Hardware CFI Features</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_cfi_support</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for CFI hardware support&quot;&quot;&quot;</span>

    <span class="n">cfi_features</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Intel CET&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Control-flow Enforcement Technology&#39;</span><span class="p">,</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;IBT (Indirect Branch Tracking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Shadow Stack&#39;</span><span class="p">],</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Available on newer Intel CPUs&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;ARM Pointer Authentication&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cryptographic signatures for return addresses&#39;</span><span class="p">,</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PAC (Pointer Authentication)&#39;</span><span class="p">,</span> <span class="s1">&#39;BTI (Branch Target Identification)&#39;</span><span class="p">],</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Available on ARMv8.3+ CPUs&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;Compiler CFI&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Software-based control flow integrity&#39;</span><span class="p">,</span>
            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Clang CFI&#39;</span><span class="p">,</span> <span class="s1">&#39;GCC -fcf-protection&#39;</span><span class="p">],</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Available in modern compilers&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Control Flow Integrity Support:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">cfi_features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Description: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Features: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Status: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">check_cfi_support</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="relro-relocation-read-only">RELRO (Relocation Read-Only)</h2>
<h3 id="relro-protection">RELRO Protection</h3>
<p>RELRO makes certain sections read-only after initialization.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>RELRO Protection Levels:
┌─────────────────────┬─────────────────────┬─────────────────────┐
│ Protection Level    │ .got Protection     │ .got.plt Protection │
├─────────────────────┼─────────────────────┼─────────────────────┤
│ No RELRO           │ Read/Write          │ Read/Write          │
│ Partial RELRO      │ Read-Only           │ Read/Write          │
│ Full RELRO         │ Read-Only           │ Read-Only           │
└─────────────────────┴─────────────────────┴─────────────────────┘
</code></pre></div></td></tr></table></div>
<h3 id="testing-relro">Testing RELRO</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_relro_protection</span><span class="p">(</span><span class="n">binary_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check RELRO protection level&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Use checksec or readelf</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;readelf&#39;</span><span class="p">,</span> <span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="n">binary_path</span><span class="p">],</span>
                              <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;GNU_RELRO&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
            <span class="c1"># Check for BIND_NOW</span>
            <span class="n">bind_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;readelf&#39;</span><span class="p">,</span> <span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="n">binary_path</span><span class="p">],</span>
                                       <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;BIND_NOW&#39;</span> <span class="ow">in</span> <span class="n">bind_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">: Full RELRO&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">: Partial RELRO&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">: No RELRO&quot;</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not analyze </span><span class="si">{</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">relro_compilation_options</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show RELRO compilation options&quot;&quot;&quot;</span>

    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;No RELRO&#39;</span><span class="p">:</span> <span class="s1">&#39;gcc -Wl,-z,norelro&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Partial RELRO&#39;</span><span class="p">:</span> <span class="s1">&#39;gcc (default)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Full RELRO&#39;</span><span class="p">:</span> <span class="s1">&#39;gcc -Wl,-z,relro,-z,now&#39;</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RELRO Compilation Options:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">relro_compilation_options</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="fortify-source">Fortify Source</h2>
<h3 id="fortify_source-protection">FORTIFY_SOURCE Protection</h3>
<p>FORTIFY_SOURCE adds bounds checking to dangerous functions.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Example of FORTIFY_SOURCE protection</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">unsafe_operations</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">large_input</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// FORTIFY_SOURCE can detect these:</span>
<span class="w">    </span><span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">large_input</span><span class="p">);</span><span class="w">        </span><span class="c1">// Buffer too small</span>
<span class="w">    </span><span class="n">memcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">large_input</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">);</span><span class="w">    </span><span class="c1">// Size exceeds buffer</span>
<span class="w">    </span><span class="n">sprintf</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">large_input</span><span class="p">);</span><span class="w"> </span><span class="c1">// Format string overflow</span>
<span class="p">}</span>

<span class="c1">// How FORTIFY_SOURCE works (simplified)</span>
<span class="cp">#ifdef __FORTIFY_SOURCE</span>
<span class="cp">#define strcpy(dest, src) \</span>
<span class="cp">    (__builtin_object_size(dest, 0) != -1 ? \</span>
<span class="cp">     __strcpy_chk(dest, src, __builtin_object_size(dest, 0)) : \</span>
<span class="cp">     strcpy(dest, src))</span>
<span class="cp">#endif</span>
</code></pre></div></td></tr></table></div>
<h3 id="testing-fortify_source">Testing FORTIFY_SOURCE</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_fortify_source</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test FORTIFY_SOURCE protection&quot;&quot;&quot;</span>

    <span class="n">test_c</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#include &lt;stdio.h&gt;</span>
<span class="s1">#include &lt;string.h&gt;</span>

<span class="s1">int main() {</span>
<span class="s1">    char small_buffer[10];</span>
<span class="s1">    char large_data[100];</span>

<span class="s1">    memset(large_data, &#39;A&#39;, sizeof(large_data));</span>
<span class="s1">    large_data[99] = &#39;</span><span class="se">\\</span><span class="s1">0&#39;;</span>

<span class="s1">    printf(&quot;Attempting dangerous copy...</span><span class="se">\\</span><span class="s1">n&quot;);</span>

<span class="s1">    // This should be caught by FORTIFY_SOURCE</span>
<span class="s1">    strcpy(small_buffer, large_data);</span>

<span class="s1">    printf(&quot;Copy succeeded</span><span class="se">\\</span><span class="s1">n&quot;);</span>
<span class="s1">    return 0;</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FORTIFY_SOURCE test:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compile with: gcc -D_FORTIFY_SOURCE=2 -O2&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Should abort with: *** buffer overflow detected ***&quot;</span><span class="p">)</span>

<span class="n">test_fortify_source</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="comprehensive-protection-analysis">Comprehensive Protection Analysis</h2>
<h3 id="binary-protection-analysis-tool">Binary Protection Analysis Tool</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BinaryProtectionAnalyzer</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary_path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binary_path</span> <span class="o">=</span> <span class="n">binary_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protections</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_all_protections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check all common protections&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_nx_dep</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_stack_canary</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_pie</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_relro</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_fortify</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">protections</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_nx_dep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check NX/DEP protection&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;readelf&#39;</span><span class="p">,</span> <span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_path</span><span class="p">],</span>
                                  <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;GNU_STACK&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="c1"># Check if stack is executable</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;GNU_STACK.*RWE&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;NX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Disabled (Executable Stack)&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;NX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Enabled&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;NX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Unknown&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;NX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Check Failed&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_stack_canary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check stack canary protection&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;objdump&#39;</span><span class="p">,</span> <span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_path</span><span class="p">],</span>
                                  <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;__stack_chk_fail&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;Stack Canary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Enabled&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;Stack Canary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Disabled&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;Stack Canary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Check Failed&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_pie</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check PIE protection&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;readelf&#39;</span><span class="p">,</span> <span class="s1">&#39;-h&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_path</span><span class="p">],</span>
                                  <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;Type:&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;DYN&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;PIE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Enabled&#39;</span>
                <span class="k">elif</span> <span class="s1">&#39;EXEC&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;PIE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Disabled&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;PIE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Unknown&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;PIE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Check Failed&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_relro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check RELRO protection&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;readelf&#39;</span><span class="p">,</span> <span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_path</span><span class="p">],</span>
                                  <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;GNU_RELRO&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                <span class="c1"># Check for BIND_NOW</span>
                <span class="n">bind_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;readelf&#39;</span><span class="p">,</span> <span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_path</span><span class="p">],</span>
                                           <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">if</span> <span class="s1">&#39;BIND_NOW&#39;</span> <span class="ow">in</span> <span class="n">bind_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;RELRO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;RELRO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Partial&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;RELRO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Disabled&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;RELRO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Check Failed&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_fortify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check FORTIFY_SOURCE&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;objdump&#39;</span><span class="p">,</span> <span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_path</span><span class="p">],</span>
                                  <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">fortify_functions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;__memcpy_chk&#39;</span><span class="p">,</span> <span class="s1">&#39;__strcpy_chk&#39;</span><span class="p">,</span> <span class="s1">&#39;__sprintf_chk&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">func</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span> <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">fortify_functions</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;FORTIFY_SOURCE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Enabled&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;FORTIFY_SOURCE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Disabled&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="p">[</span><span class="s1">&#39;FORTIFY_SOURCE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Check Failed&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print protection analysis report&quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Binary Protection Analysis: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">binary_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">protection</span><span class="p">,</span> <span class="n">status</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">protections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;Enabled&#39;</span> <span class="ow">in</span> <span class="n">status</span> <span class="ow">or</span> <span class="s1">&#39;Full&#39;</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>
                <span class="n">indicator</span> <span class="o">=</span> <span class="s2">&quot;✓&quot;</span>
            <span class="k">elif</span> <span class="s1">&#39;Disabled&#39;</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>
                <span class="n">indicator</span> <span class="o">=</span> <span class="s2">&quot;✗&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">indicator</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">indicator</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">protection</span><span class="si">:</span><span class="s2">15</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Usage example</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_binary_protections</span><span class="p">(</span><span class="n">binary_path</span><span class="p">):</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">BinaryProtectionAnalyzer</span><span class="p">(</span><span class="n">binary_path</span><span class="p">)</span>
    <span class="n">analyzer</span><span class="o">.</span><span class="n">check_all_protections</span><span class="p">()</span>
    <span class="n">analyzer</span><span class="o">.</span><span class="n">print_report</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">protections</span>

<span class="c1"># Example usage</span>
<span class="c1"># protections = analyze_binary_protections(&#39;./vulnerable_program&#39;)</span>
</code></pre></div></td></tr></table></div>
<h2 id="system-level-protections">System-Level Protections</h2>
<h3 id="kernel-protections">Kernel Protections</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_kernel_protections</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check kernel-level protections&quot;&quot;&quot;</span>

    <span class="n">kernel_protections</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;KASLR&#39;</span><span class="p">:</span> <span class="s1">&#39;/proc/sys/kernel/randomize_va_space&#39;</span><span class="p">,</span>
        <span class="s1">&#39;KPTI&#39;</span><span class="p">:</span> <span class="s1">&#39;/sys/devices/system/cpu/vulnerabilities/meltdown&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SMEP&#39;</span><span class="p">:</span> <span class="s1">&#39;dmesg | grep SMEP&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SMAP&#39;</span><span class="p">:</span> <span class="s1">&#39;dmesg | grep SMAP&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kernel Protection Status:&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check ASLR</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/proc/sys/kernel/randomize_va_space&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">aslr_level</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">levels</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;0&#39;</span><span class="p">:</span> <span class="s1">&#39;Disabled&#39;</span><span class="p">,</span>
                <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Conservative&#39;</span><span class="p">,</span>
                <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="s1">&#39;Full&#39;</span>
            <span class="p">}</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ASLR: </span><span class="si">{</span><span class="n">levels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">aslr_level</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">aslr_level</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ASLR: Check Failed&quot;</span><span class="p">)</span>

    <span class="c1"># Check CPU vulnerabilities</span>
    <span class="n">vuln_files</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;meltdown&#39;</span><span class="p">,</span> <span class="s1">&#39;spectre_v1&#39;</span><span class="p">,</span> <span class="s1">&#39;spectre_v2&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;spec_store_bypass&#39;</span><span class="p">,</span> <span class="s1">&#39;l1tf&#39;</span><span class="p">,</span> <span class="s1">&#39;mds&#39;</span>
    <span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">CPU Vulnerability Mitigations:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">vuln_files</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/sys/devices/system/cpu/vulnerabilities/</span><span class="si">{</span><span class="n">vuln</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vuln</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">continue</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_address_space_layout</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check current process address space layout&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/proc/self/maps&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">maps</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Current Process Memory Layout:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Address Range          Perms  Mapping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">maps</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[:</span><span class="mi">15</span><span class="p">]:</span>  <span class="c1"># First 15 mappings</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">addr_range</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">perms</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">mapping</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="s2">&quot;[anonymous]&quot;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">addr_range</span><span class="si">:</span><span class="s2">18</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">perms</span><span class="si">:</span><span class="s2">5</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mapping</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not read memory maps&quot;</span><span class="p">)</span>

<span class="n">check_kernel_protections</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="key-takeaways">Key Takeaways</h2>
<div class="admonition important">
<p class="admonition-title">Security Mitigation Fundamentals</p>
<ul>
<li><strong>Defense in depth</strong> - Multiple layers of protection work together</li>
<li><strong>Each mitigation addresses specific attack vectors</strong> - No single protection is sufficient</li>
<li><strong>Hardware and software cooperation</strong> - Modern protections leverage both</li>
<li><strong>Performance trade-offs</strong> - Security comes with computational cost</li>
<li><strong>Bypass techniques exist</strong> - Attackers continuously develop new methods</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Common Misconceptions</p>
<ul>
<li>One protection is enough to prevent all attacks</li>
<li>Mitigations make exploitation impossible</li>
<li>All binaries have the same protection levels</li>
<li>Protections are either fully on or off</li>
<li>Modern systems are completely secure</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Practical Applications</p>
<ul>
<li>Always enable available protections during compilation</li>
<li>Understand what each protection defends against</li>
<li>Test protection effectiveness in your environment</li>
<li>Keep systems updated for latest mitigation features</li>
<li>Combine mitigations with secure coding practices</li>
</ul>
</div>
<hr />
<p><em>Next: <a href="../02-canary-bypass/">Stack Canary Bypass</a></em></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.sections", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>